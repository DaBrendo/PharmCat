--PharmCat 2.2 TABLE
--CREATE OR REPLACE VIEW `hca-usr-gbc-gme-prod.BDO6585.SYMEDTABLE` ASSELECT DISTINCTMed.Clinical_Phrm_Mnem_CS AS MED_MNEMONIC,Coalesce(Cast(Substring(DCRef.Clinical_Phrm_RXM_RXNORM_Code, 2) AS STRING), Sym1.Standard_Code) AS RXCUI,Coalesce(Norm.RxNorm_Desc, Sym1.Standard_Code_Desc) AS RXNORM_DESCRIPTIONFROM `hca-usr-gbc-gme-prod.BDO6585.0000_JEFF_TEST` popINNER JOIN `hca-hin-dev-cur-clinical.edwcdm_views.clinical_patient_med_list` MedON pop.Patient_dw_id=Med.Patient_dw_idAND pop.Coid=Med.CoidAND Med.Clinical_Systems_Module_Code NOT IN ('TEV','IAT')LEFT JOIN `hca-hin-prod-cur-clinical.edwcl_views.ref_clinical_phrm_rxm_code_map` DCRefON Med.COID = DCRef.COIDAND Med.Clinical_Phrm_Mnem_CS = DCRef.Clinical_Phrm_RXM_Mnemonic_CSLEFT JOIN `hca-hin-prod-cur-clinical.edwcdm_views.ref_symedical_value_set` sym1ON Med.COID = sym1.COIDAND Med.Clinical_Phrm_Mnem_CS = sym1.source_term_codeAND sym1.map_domain = 'MED'LEFT JOIN `hca-hin-prod-cur-clinical.edwcl_views.ref_rxnorm` NormON Substring(DCRef.Clinical_Phrm_RXM_RXNORM_Code, 2) = Cast(Norm.RxNorm_Id AS STRING)